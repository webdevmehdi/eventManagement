"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("@react-pdf-viewer/core");function n(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var r=n(e);
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var o,a=function(e){var t=e.count,n=e.items;if(t>=0)return!1;var r=n.length;if(0===r)return!1;for(var o=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}([],n,!0);o.length>0;){var a=o.shift(),i=a.items;a.count&&i&&a.count>0&&i.length>0&&(r+=i.length,o.push.apply(o,i))}return Math.abs(t)===r},i=function(){return r.createElement(t.Icon,{size:16},r.createElement("path",{d:"M6.427,8.245A.5.5,0,0,1,6.862,7.5H17.138a.5.5,0,0,1,.435.749l-5.139,9a.5.5,0,0,1-.868,0Z"}))},c=function(){return r.createElement(t.Icon,{size:16},r.createElement("path",{d:"M9.248,17.572a.5.5,0,0,1-.748-.434V6.862a.5.5,0,0,1,.748-.434l8.992,5.138a.5.5,0,0,1,0,.868Z"}))},s=function(e){var t=e.bookmark,n=e.depth,o=e.doc,s=e.index,u=e.isBookmarkExpanded,m=e.numberOfSiblings,d=e.store,f=e.onJumpToDest,k=r.useMemo((function(){return a(t)}),[t]),p=u?u({bookmark:t,doc:o,depth:n,index:s}):!k,b=r.useState(p),v=b[0],E=b[1],g=t.items&&t.items.length>0;return r.createElement("li",{"aria-expanded":v?"true":"false","aria-label":t.title,"aria-level":n+1,"aria-posinset":s+1,"aria-setsize":m,role:"treeitem",tabIndex:-1},r.createElement("div",{className:"rpv-bookmark__item",style:{paddingLeft:"".concat(1.25*n,"rem")},onClick:function(){!g&&t.dest&&f(t.dest)}},g?r.createElement("span",{className:"rpv-bookmark__toggle",onClick:function(){return E((function(e){return!e}))}},v?r.createElement(i,null):r.createElement(c,null)):r.createElement("span",{className:"rpv-bookmark__toggle"}),t.url?r.createElement("a",{className:"rpv-bookmark__title",href:t.url,rel:"noopener noreferrer nofollow",target:t.newWindow?"_blank":""},t.title):r.createElement("div",{className:"rpv-bookmark__title","aria-label":t.title,onClick:function(){g&&t.dest&&f(t.dest)}},t.title)),g&&v&&r.createElement(l,{bookmarks:t.items,depth:n+1,doc:o,isBookmarkExpanded:u,isRoot:!1,store:d,onJumpToDest:f}))},l=function(e){var t=e.bookmarks,n=e.depth,o=void 0===n?0:n,a=e.doc,i=e.isBookmarkExpanded,c=e.isRoot,l=e.store,u=e.onJumpToDest;return r.createElement("ul",{className:"rpv-bookmark__list",role:c?"tree":"group",tabIndex:-1},t.map((function(e,n){return r.createElement(s,{bookmark:e,depth:o,doc:a,index:n,isBookmarkExpanded:i,key:n,numberOfSiblings:t.length,store:l,onJumpToDest:u})})))};!function(e){e[e.Collapse=0]="Collapse",e[e.Expand=1]="Expand"}(o||(o={}));var u=function(e){var n=e.bookmarks,a=e.doc,i=e.isBookmarkExpanded,c=e.store,s=e.onJumpToDest,u=r.useRef(),m=r.useState(c.get("linkAnnotations")||{}),d=m[0],f=m[1],k=function(e,t){var n=e.dest;n&&"string"==typeof n&&t[n]&&(t[n].querySelectorAll('a[data-annotation-link-dest="'.concat(n,'"]')).forEach((function(t){t.setAttribute("aria-label",e.title)})),e.items&&e.items.length&&e.items.forEach((function(e){return k(e,t)})))},p=function(e){return f(e)},b=function(e){var t=u.current;if(t&&e.target instanceof HTMLElement&&t.contains(e.target))switch(e.key){case"ArrowDown":e.preventDefault(),E((function(e,t){return e.indexOf(t)+1}));break;case"ArrowLeft":e.preventDefault(),g(o.Collapse);break;case"ArrowRight":e.preventDefault(),g(o.Expand);break;case"ArrowUp":e.preventDefault,E((function(e,t){return e.indexOf(t)-1}));break;case"End":e.preventDefault(),E((function(e,t){return e.length-1}));break;case" ":case"Enter":case"Space":e.preventDefault(),v();break;case"Home":e.preventDefault(),E((function(e,t){return 0}))}},v=function(){var e=document.activeElement.closest(".rpv-bookmark__item").querySelector(".rpv-bookmark__title");e&&e.click()},E=function(e){var t=u.current,n=[].slice.call(t.getElementsByClassName("rpv-bookmark__item"));if(0!==n.length){var r=document.activeElement,o=n[Math.min(n.length-1,Math.max(0,e(n,r)))];r.setAttribute("tabindex","-1"),o.setAttribute("tabindex","0"),o.focus()}},g=function(e){var t=u.current;if(0!==[].slice.call(t.getElementsByClassName("rpv-bookmark__item")).length){var n=document.activeElement.closest(".rpv-bookmark__item"),r=e===o.Collapse?"true":"false";if(n&&n.parentElement.getAttribute("aria-expanded")===r){var a=n.querySelector(".rpv-bookmark__toggle");a&&a.click()}}};return r.useEffect((function(){return document.addEventListener("keydown",b),c.subscribe("linkAnnotations",p),function(){document.removeEventListener("keydown",b),c.unsubscribe("linkAnnotations",p)}}),[]),r.useEffect((function(){n.forEach((function(e){return k(e,d)}))}),[d]),r.useEffect((function(){var e=u.current;if(e){var t=[].slice.call(e.getElementsByClassName("rpv-bookmark__item"));t.length>0&&(t[0].focus(),t[0].setAttribute("tabindex","0"))}}),[]),r.createElement("div",{ref:u},r.createElement(l,{bookmarks:n,depth:0,doc:a,isBookmarkExpanded:i,isRoot:!0,store:c,onJumpToDest:function(e){t.getDestination(a,e).then((function(e){var t=e.pageIndex,n=e.bottomOffset,r=e.leftOffset,o=e.scaleTo;s(t,n,r,o)}))}}))},m=function(e){var n=e.doc,o=e.isBookmarkExpanded,a=e.store,i=e.onJumpToDest,c=r.useContext(t.LocalizationContext).l10n,s=r.useContext(t.ThemeContext).direction===t.TextDirection.RightToLeft,l=r.useState({isLoaded:!1,items:[]}),m=l[0],d=l[1];return r.useEffect((function(){d({isLoaded:!1,items:[]}),n.getOutline().then((function(e){d({isLoaded:!0,items:e||[]})}))}),[n]),m.isLoaded?0===m.items.length?r.createElement("div",{"data-testid":"bookmark__empty",className:t.classNames({"rpv-bookmark__empty":!0,"rpv-bookmark__empty--rtl":s})},c&&c.bookmark?c.bookmark.noBookmark:"There is no bookmark"):r.createElement("div",{"data-testid":"bookmark__container",className:t.classNames({"rpv-bookmark__container":!0,"rpv-bookmark__container--rtl":s})},r.createElement(u,{bookmarks:m.items,doc:n,isBookmarkExpanded:o,store:a,onJumpToDest:i})):r.createElement("div",{className:"rpv-bookmark__loader"},r.createElement(t.Spinner,null))},d=function(e){var n=e.isBookmarkExpanded,o=e.store,a=r.useState(o.get("doc")),i=a[0],c=a[1],s=function(e){c(e)};return r.useEffect((function(){return o.subscribe("doc",s),function(){o.unsubscribe("doc",s)}}),[]),i?r.createElement(m,{doc:i,isBookmarkExpanded:n,store:o,onJumpToDest:function(e,t,n,r){var a=o.get("jumpToDestination");a&&a(e,t,n,r)}}):r.createElement("div",{className:"rpv-bookmark__loader"},r.createElement(t.Spinner,null))};exports.DownArrowIcon=i,exports.RightArrowIcon=c,exports.bookmarkPlugin=function(){var e=r.useMemo((function(){return t.createStore({linkAnnotations:{}})}),[]);return{install:function(t){e.update("jumpToDestination",t.jumpToDestination)},onDocumentLoad:function(t){e.update("doc",t.doc)},Bookmarks:function(t){return r.createElement(d,{isBookmarkExpanded:null==t?void 0:t.isBookmarkExpanded,store:e})},onAnnotationLayerRender:function(t){if(t.annotations.length){var n=t.annotations.filter((function(e){return"Link"===e.subtype}));if(n.length){var r=e.get("linkAnnotations")||{};n.forEach((function(e){return r[e.dest]=t.container})),e.update("linkAnnotations",r)}}}}};
